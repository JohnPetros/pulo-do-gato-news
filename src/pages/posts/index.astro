---
import { postsService } from '@/cms/index';
import { NAV_LINKS } from '@/constants/index';

import Root from '@/layouts/root/index.astro';
import InputSubmit from '@/components/input-submit/index.astro';
import PostCard from '@/components/post-card/index.astro';
import CategoriesFilter from './categories-filter/index.astro';

const search = Astro.url.searchParams.get('search');
const category = Astro.url.searchParams.get('category');

const posts = await postsService.fetchPosts(category, search);
---

<Root title='NotÃ­cias'>
  <div class='large-container px-6 lg:px-0'>
    <form>
      <div class='max-w-2xl'>
        <InputSubmit
          title='Pesquisar'
          name='search'
          value={search ?? ''}
          placeholder='Novidades, descobertas etc...'
        />
      </div>
      <div class='mt-6'>
        <CategoriesFilter activeCategory={category} />
      </div>
    </form>
    <div class='grid grid-cols-1 lg:grid-cols-2 mt-6 gap-6'>
      {posts.map(post => <PostCard {...post} />)}
    </div>
  </div>
</Root>
